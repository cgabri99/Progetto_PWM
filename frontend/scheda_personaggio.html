<!doctype html>
<html lang="it" data-bs-theme="dark">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Scheda personaggio</title>
    <script type="text/javascript" src="../backend/script.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>

<body onload="aggiorna();" class="gradient-custom">
    <div class="container">
        <button class="btn btn-primary m-3" type="button" onclick=" window.history.back();">Indietro</button>
        <h1 class="text-center my-2">Descrizione personaggio</h1>

        <div id="heroCard" class="card m-3">
            <div class="row g-0">
                <div class="col-md-4">
                    <img class="img-fluid rounded-start" alt="...">
                </div>
                <div class="col-md-8">
                    <div class="card-body">
                        <h5 class="card-title"></h5>
                        <p class="card-text"></p>
                    </div>
                </div>
            </div>
        </div>

        <div class="row row-cols-lg-3 row-cols-md-2 row-cols-1">
            <div id="col_comics" class="col d-none">
                <h1 id="title_comics" class="text-center my-3 d-none">Fumetti in cui appare</h1>
                <div id="carousel_comics" class="carousel slide">
                    <div id="container_comics" class="carousel-inner">
                        <div id="item_comics" class="carousel-item d-none">
                            <img src="" class="d-block img-carousel" onmouseover="">
                        </div>
                    </div>
                    <button id="prev_comics" class="carousel-control-prev d-none" type="button"
                        data-bs-target="#carousel_comics" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>
                    <button id="next_comics" class="carousel-control-next d-none" type="button"
                        data-bs-target="#carousel_comics" data-bs-slide="next">
                        <span class="carousel-control-next-icon"></span>
                        <span class="visually-hidden">Next</span>
                    </button>
                </div>

                <!-- <div id="containerComics" class="row row-cols-2 row-cols-sm-2 row-cols-md-3 row-cols-lg-5 g-4 mt-2 mx-1">
                    <div id="comicCard" class="col d-none" style="max-height: 30rem;">
                        <div class="card h-100">
                            <img src="" class="card-img-top" alt="...">
                            <div class="card-body">
                                <h5 class="card-title"></h5>
                                <p class="card-text"></p>
                            </div>
                        </div>
                    </div>
                </div> -->
            </div>
            <div id="col_series" class="col d-none">
                <h1 id="title_series" class="text-center my-3 d-none">Serie in cui appare</h1>
                <div id="carousel_series" class="carousel slide">
                    <div id="container_series" class="carousel-inner">
                        <div id="item_series" class="carousel-item d-none">
                            <img src="" class="d-block img-carousel" onmouseover="">
                        </div>
                    </div>
                    <button id="prev_series" class="carousel-control-prev d-none" type="button"
                        data-bs-target="#carousel_series" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>
                    <button id="next_series" class="carousel-control-next d-none" type="button"
                        data-bs-target="#carousel_series" data-bs-slide="next">
                        <span class="carousel-control-next-icon"></span>
                        <span class="visually-hidden">Next</span>
                    </button>
                </div>

                <!-- <div id="containerSeries" class="row row-cols-2 row-cols-sm-2 row-cols-md-3 row-cols-lg-5 g-4 mt-2 mx-1">
                    <div id="serieCard" class="col d-none" style="max-height: 30rem;">
                        <div class="card h-100">
                            <img src="" class="card-img-top" alt="...">
                            <div class="card-body">
                                <h5 class="card-title"></h5>
                                <p class="card-text"></p>
                            </div>
                        </div>
                    </div>
                </div> -->
            </div>

            <div id="col_events" class="col d-none">
                <h1 id="title_events" class="text-center my-3 d-none">Eventi in cui appare</h1>
                <div id="carousel_events" class="carousel slide">
                    <div id="container_events" class="carousel-inner">
                        <div id="item_events" class="carousel-item d-none">
                            <img src="" class="d-block img-carousel" onmouseover="">
                        </div>
                    </div>
                    <button id="prev_events" class="carousel-control-prev d-none" type="button"
                        data-bs-target="#carousel_events" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>
                    <button id="next_events" class="carousel-control-next d-none" type="button"
                        data-bs-target="#carousel_events" data-bs-slide="next">
                        <span class="carousel-control-next-icon"></span>
                        <span class="visually-hidden">Next</span>
                    </button>
                </div>

                <!-- <div id="containerEvents" class="row row-cols-2 row-cols-sm-2 row-cols-md-3 row-cols-lg-5 g-4 mt-2 mx-1">
                    <div id="eventCard" class="col d-none" style="max-height: 30rem;">
                        <div class="card h-100">
                            <img src="" class="card-img-top" alt="...">
                            <div class="card-body">
                                <h5 class="card-title"></h5>
                                <p class="card-text"></p>
                            </div>
                        </div>
                    </div>
                </div> -->
            </div>


        </div>
    </div>

    <script>
        function aggiorna() {
            const searchParams = new URLSearchParams(location.search);
            URI = searchParams.get('URI');

            getFromMarvel(URI, "")
                .then((result) => popolaScehda(result.data.results))
                .catch((error) => console.error(error));
        }

        function popolaScehda(dati) {
            console.log(dati);
            heroCard = document.getElementById('heroCard');

            hero = dati[0];

            title = heroCard.getElementsByClassName('card-title')[0];
            image = heroCard.getElementsByClassName('img-fluid')[0];
            description = heroCard.getElementsByClassName('card-text')[0];

            title.innerHTML = hero.name;
            image.src = hero.thumbnail.path + "." + hero.thumbnail.extension;
            description.innerHTML = hero.description;

            // richiestaMarvel(hero.comics.collectionURI, 'comicCard', 'containerComics', 'titleComics');

            // richiestaMarvel(hero.series.collectionURI, 'serieCard', 'containerSeries', 'titleSeries');

            // richiestaMarvel(hero.events.collectionURI, 'eventCard', 'containerEvents', 'titleEvents');

            richiestaMarvelCarousel(hero.comics.collectionURI, 'comics');
            richiestaMarvelCarousel(hero.series.collectionURI, 'series');
            richiestaMarvelCarousel(hero.events.collectionURI, 'events');
        }

        // function popolaMenu(data, nomeCard, nomeContainer, nomeTitolo) {
        //     //console.log(series);
        //     card = document.getElementById(nomeCard);
        //     container = document.getElementById(nomeContainer);
        //     header = document.getElementById(nomeTitolo);
        //     container.innerHTML = "";
        //     container.append(card);

        //     for (i = 0; i < data.length; i++) {
        //         element = data[i];
        //         clone = card.cloneNode(true);
        //         clone.id = 'serieClone_' + i;

        //         title = clone.getElementsByClassName('card-title')[0];
        //         // description = clone.getElementsByClassName('card-text')[0];
        //         image = clone.getElementsByClassName('card-img-top')[0];

        //         title.innerHTML = element.title;
        //         image.src = element.thumbnail.path + "." + element.thumbnail.extension;
        //         // description.innerHTML = serie.description;

        //         header.classList.remove('d-none');
        //         clone.classList.remove('d-none');
        //         card.before(clone);
        //     }
        // }

        // function richiestaMarvel(URI, nomeCard, nomeContainer, nomeTitolo) {
        //     URI = URI.slice(URI.indexOf(1) + 2);
        //     //fetch portale marvel
        //     getFromMarvel(URI, "")
        //         .then((result) => popolaMenu(result.data.results, nomeCard, nomeContainer, nomeTitolo))
        //         .catch((error) => console.error(error));
        // }

        function richiestaMarvelCarousel(URI, nomeCard, nomeContainer, nomeTitolo) {
            URI = URI.slice(URI.indexOf(1) + 2);
            //fetch portale marvel
            getFromMarvel(URI, "")
                .then((result) => popolacarousel(result.data.results, nomeCard, nomeContainer, nomeTitolo))
                .catch((error) => console.error(error));
        }

        function popolacarousel(data, type) {
            console.log(data);
            slide = document.getElementById('item_' + type);
            container = document.getElementById('container_' + type);
            header = document.getElementById('title_' + type);
            btn_prev = document.getElementById('prev_' + type);
            btn_next = document.getElementById('next_' + type);
            col = document.getElementById('col_' + type);


            container.innerHTML = "";
            container.append(slide);
            for (i = 0; i < data.length; i++) {
                element = data[i];
                clone = slide.cloneNode(true);
                clone.id = 'slideClone_' + i;

                // title = clone.getElementsByClassName('carouselHeader')[0];
                // description = clone.getElementsByClassName('card-text')[0];
                image = clone.getElementsByClassName('img-carousel')[0];

                // title.innerHTML = element.title;
                image.src = element.thumbnail.path + "." + element.thumbnail.extension;
                // description.innerHTML = serie.description;

                header.classList.remove('d-none');
                clone.classList.remove('d-none');
                col.classList.remove('d-none');
                if (i === 1) {
                    btn_next.classList.remove('d-none');
                    btn_prev.classList.remove('d-none');
                }
                if (i === 0) {
                    clone.classList.add('active');
                }
                slide.before(clone);
            }
            container.removeChild(slide);
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
</body>

</html>